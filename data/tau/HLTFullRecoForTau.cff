
#--------------------------------
#Regional reconstruction for HLT
#Trajectory Builders

#Level2.5
es_module trajFilterL25 = trajectoryFilterESProducer from 
"TrackingTools/TrajectoryFiltering/data/TrajectoryFilterESProducer.cfi"
  replace trajFilterL25.ComponentName = "trajFilterL25"
  replace trajFilterL25.filterPset.minPt           = 5.0
  replace trajFilterL25.filterPset.maxNumberOfHits = 7

es_module trajBuilderL25 = CkfTrajectoryBuilder from "RecoTracker/CkfPattern/data/CkfTrajectoryBuilderESProducer.cfi" 
  replace trajBuilderL25.ComponentName = "trajBuilderL25"
  replace trajBuilderL25.trajectoryFilterName = "trajFilterL25"
  replace trajBuilderL25.maxCand              = 1
  replace trajBuilderL25.alwaysUseInvalidHits = false

#Level 3.0
es_module trajFilterL3 = trajectoryFilterESProducer from 
"TrackingTools/TrajectoryFiltering/data/TrajectoryFilterESProducer.cfi"
  replace trajFilterL3.ComponentName = "trajFilterL3"
  replace trajFilterL3.filterPset.maxNumberOfHits = 7

es_module trajBuilderL3 = CkfTrajectoryBuilder from "RecoTracker/CkfPattern/data/CkfTrajectoryBuilderESProducer.cfi" 
  replace trajBuilderL3.ComponentName = "trajBuilderL3"
  replace trajBuilderL3.trajectoryFilterName = "trajFilterL3"
  replace trajBuilderL3.alwaysUseInvalidHits = false


#---------------------------------------
#SingleTau

# Regional Tk reconstruction for SingleTauCollection
#Level 2.5
module l25SingleTauPixelSeeds = tauRegionalPixelSeedGenerator from 
"RecoTauTag/HLTProducers/data/TauRegionalPixelSeedGenerator.cfi"
replace l25SingleTauPixelSeeds.RegionFactoryPSet.RegionPSet.JetSrc = ecalSingleTauIsolated:Isolated

module ckfTrackCandidatesL25SingleTau =  ckfTrackCandidates from "RecoTracker/CkfPattern/data/CkfTrackCandidates.cfi"    
replace ckfTrackCandidatesL25SingleTau.SeedProducer  = "l25SingleTauPixelSeeds"
replace ckfTrackCandidatesL25SingleTau.TrajectoryBuilder    = "trajBuilderL25"

module ctfWithMaterialTracksL25SingleTau = ctfWithMaterialTracks from 
"RecoTracker/TrackProducer/data/CTFFinalFitWithMaterial.cfi"
replace ctfWithMaterialTracksL25SingleTau.src = "ckfTrackCandidatesL25SingleTau"

#L25Trk reconstruction
sequence ckfTracksL25SingleTau = {l25SingleTauPixelSeeds,ckfTrackCandidatesL25SingleTau,ctfWithMaterialTracksL25SingleTau}

#Level 3.0
module l3SingleTauPixelSeeds = tauRegionalPixelSeedGenerator from 
"RecoTauTag/HLTProducers/data/TauRegionalPixelSeedGenerator.cfi"
replace l3SingleTauPixelSeeds.RegionFactoryPSet.RegionPSet = {
    double deltaEtaRegion = 0.5
    double deltaPhiRegion = 0.5
    double ptMin = 1.0
    double originZPos = 0.0
    double originRadius = 0.2
    double originHalfLength = 0.2
    bool precise = true
    InputTag JetSrc    = isolatedL25SingleTau
    InputTag vertexSrc = pixelVertices
}

module ckfTrackCandidatesL3SingleTau =  ckfTrackCandidates from "RecoTracker/CkfPattern/data/CkfTrackCandidates.cfi"    
replace ckfTrackCandidatesL3SingleTau.SeedProducer  = "l3SingleTauPixelSeeds"
replace ckfTrackCandidatesL3SingleTau.TrajectoryBuilder    = "trajBuilderL3"

module ctfWithMaterialTracksL3SingleTau = ctfWithMaterialTracks from 
"RecoTracker/TrackProducer/data/CTFFinalFitWithMaterial.cfi"
replace ctfWithMaterialTracksL3SingleTau.src = "ckfTrackCandidatesL3SingleTau"

#L3Trk reconstruction
sequence ckfTracksL3SingleTau = {l3SingleTauPixelSeeds,ckfTrackCandidatesL3SingleTau,ctfWithMaterialTracksL3SingleTau}


#-------------------------
#SingleTauMET

#Regional Track reconstruction
#Level 2.5
module l25SingleTauMETPixelSeeds = tauRegionalPixelSeedGenerator from 
"RecoTauTag/HLTProducers/data/TauRegionalPixelSeedGenerator.cfi"
replace l25SingleTauMETPixelSeeds.RegionFactoryPSet.RegionPSet.JetSrc = ecalSingleTauMETIsolated:Isolated

module ckfTrackCandidatesL25SingleTauMET =  ckfTrackCandidates from "RecoTracker/CkfPattern/data/CkfTrackCandidates.cfi"    
replace ckfTrackCandidatesL25SingleTauMET.SeedProducer  = "l25SingleTauMETPixelSeeds"
replace ckfTrackCandidatesL25SingleTauMET.TrajectoryBuilder    = "trajBuilderL25"

module ctfWithMaterialTracksL25SingleTauMET = ctfWithMaterialTracks from 
"RecoTracker/TrackProducer/data/CTFFinalFitWithMaterial.cfi"
replace ctfWithMaterialTracksL25SingleTauMET.src = "ckfTrackCandidatesL25SingleTauMET"

#L25Trk reconstruction
sequence ckfTracksL25SingleTauMET = {l25SingleTauMETPixelSeeds,ckfTrackCandidatesL25SingleTauMET,ctfWithMaterialTracksL25SingleTauMET}

#Level 3.0
module l3SingleTauMETPixelSeeds = tauRegionalPixelSeedGenerator from 
"RecoTauTag/HLTProducers/data/TauRegionalPixelSeedGenerator.cfi"
replace l3SingleTauMETPixelSeeds.RegionFactoryPSet.RegionPSet = {
 double deltaPhiRegion = 0.5
 double deltaEtaRegion = 0.5
    double ptMin = 1.0
    double originZPos = 0.0
    double originRadius = 0.2
    double originHalfLength = 0.2
    bool precise = true
    InputTag JetSrc = isolatedL25SingleTauMET
    InputTag vertexSrc = pixelVertices
}

module ckfTrackCandidatesL3SingleTauMET =  ckfTrackCandidates from "RecoTracker/CkfPattern/data/CkfTrackCandidates.cfi"    
replace ckfTrackCandidatesL3SingleTauMET.SeedProducer  = "l3SingleTauMETPixelSeeds"
replace ckfTrackCandidatesL3SingleTauMET.TrajectoryBuilder    = "trajBuilderL3"

module ctfWithMaterialTracksL3SingleTauMET = ctfWithMaterialTracks from "RecoTracker/TrackProducer/data/CTFFinalFitWithMaterial.cfi"
replace ctfWithMaterialTracksL3SingleTauMET.src = "ckfTrackCandidatesL3SingleTauMET"

#L3Trk reconstruction
sequence ckfTracksL3SingleTauMET = {l3SingleTauMETPixelSeeds,ckfTrackCandidatesL3SingleTauMET,ctfWithMaterialTracksL3SingleTauMET}

#--------------------------
#DoubleTau

#-------------
#Common include files

#Primary Vertex
include "HLTrigger/Configuration/data/common/Vertexing.cff"

#TransientTrackingBuilder
include "RecoTracker/TransientTrackingRecHit/data/TransientTrackingRecHitBuilder.cfi"

#CaloMet stuff
include "HLTrigger/Configuration/data/common/RecoJetMET.cff"

# Tracker reconstruction
// include "HLTrigger/Configuration/data/common/TrackerTracks.cff"

#
#XChannels
#

#ElectronTau
#
# L25 ElectronTau
#

# Regional track reconstruction
module hltTauRegionalPixelSeedL25ElectronTau = tauRegionalPixelSeedGenerator from "RecoTauTag/HLTProducers/data/TauRegionalPixelSeedGenerator.cfi"
 replace hltTauRegionalPixelSeedL25ElectronTau.RegionFactoryPSet.RegionPSet.ptMin  = 5.0
 replace hltTauRegionalPixelSeedL25ElectronTau.RegionFactoryPSet.RegionPSet.JetSrc = hltL2TauJetsProviderElectronTau

# see SingleTau.cff for trajBuilderL25 definition
module hltCkfTrackCandidatesL25ElectronTau = ckfTrackCandidates from "RecoTracker/CkfPattern/data/CkfTrackCandidates.cfi"
 replace hltCkfTrackCandidatesL25ElectronTau.SeedProducer      = "hltTauRegionalPixelSeedL25ElectronTau"
 replace hltCkfTrackCandidatesL25ElectronTau.TrajectoryBuilder = "trajBuilderL25"

module hltCtfWithMaterialTracksL25ElectronTau = ctfWithMaterialTracks from "RecoTracker/TrackProducer/data/CTFFinalFitWithMaterial.cfi"
 replace hltCtfWithMaterialTracksL25ElectronTau.src = "hltCkfTrackCandidatesL25ElectronTau"


#
# L3 ElectronTau
#

# Regional Tk reconstruction for ElectronTauCollection 
module hltTauRegionalPixelSeedsL3ElectronTau = tauRegionalPixelSeedGenerator from "RecoTauTag/HLTProducers/data/TauRegionalPixelSeedGenerator.cfi"
 replace hltTauRegionalPixelSeedsL3ElectronTau.RegionFactoryPSet.RegionPSet.JetSrc = hltIsolatedTauJetsSelectorL25ElectronTau
 replace hltTauRegionalPixelSeedsL3ElectronTau.RegionFactoryPSet.RegionPSet.ptMin          = 1.0
 replace hltTauRegionalPixelSeedsL3ElectronTau.RegionFactoryPSet.RegionPSet.deltaEtaRegion = 0.5
 replace hltTauRegionalPixelSeedsL3ElectronTau.RegionFactoryPSet.RegionPSet.deltaPhiRegion = 0.5

module hltCkfTrackCandidatesL3ElectronTau =  ckfTrackCandidates from "RecoTracker/CkfPattern/data/CkfTrackCandidates.cfi"
 replace hltCkfTrackCandidatesL3ElectronTau.SeedProducer      = "hltTauRegionalPixelSeedsL3ElectronTau"
 replace hltCkfTrackCandidatesL3ElectronTau.TrajectoryBuilder = "trajBuilderL3"

module hltCtfWithMaterialTracksL3ElectronTau = ctfWithMaterialTracks from "RecoTracker/TrackProducer/data/CTFFinalFitWithMaterial.cfi"
 replace hltCtfWithMaterialTracksL3ElectronTau.src = "hltCkfTrackCandidatesL3ElectronTau"



sequence hltTracksL25ElectronTau = {
 hltTauRegionalPixelSeedL25ElectronTau,
 hltCkfTrackCandidatesL25ElectronTau,
 hltCtfWithMaterialTracksL25ElectronTau
}

sequence hltTracksL3ElectronTau = {
 hltTauRegionalPixelSeedsL3ElectronTau,
 hltCkfTrackCandidatesL3ElectronTau,
 hltCtfWithMaterialTracksL3ElectronTau
}

#Muon+Tau

