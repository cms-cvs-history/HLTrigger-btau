#! /bin/env cmsRun

process HLT = {
    
    # initialize MessageLogger
    include "Configuration/StandardSequences/data/FakeConditions.cff"
    untracked PSet options = {
        include "FWCore/Framework/test/cmsExceptionsFatalOption.cff"
        untracked bool wantSummary = true
        untracked bool makeTriggerResults = true 
    }
    
    # include services
    include "Configuration/ReleaseValidation/data/Services.cfi"
    include "FWCore/MessageService/data/MessageLogger.cfi"
    replace MessageLogger.cout.threshold = "ERROR"
    replace MessageLogger.cerr.default.limit = 2
    
    # initialize random number seeds
    service = RandomNumberGeneratorService {
        untracked uint32 sourceSeed = 123456789
        PSet moduleSeeds = {
            untracked uint32 VtxSmeared = 98765432
            untracked uint32 g4SimHits  = 11
        }
    }
    
    
    # generation parameters
    source = PythiaSource 
    { 
        untracked int32 maxEvents = 1
        untracked int32 pythiaPylistVerbosity = 0
        untracked bool  pythiaHepMCVerbosity = false
        untracked int32 maxEventsToPrint = 0
        
        PSet PythiaParameters = {
            
            # This is a vector of ParameterSet names to be read, in this order
            vstring parameterSets = {
                "pythiaUESettings", 
                "processParameters",
                "pythiaMSSMmhmax"
            }
            
            include "Configuration/Generator/data/PythiaUESettings.cfi"
            
            vstring processParameters = {
                "MSEL=0                  ! user control",
                "MSUB(181)= 1            ! gg->QQbarH (MSSM)",
                #"TAUO = 0 0             !          Registered by Alexandre.Nikitenko@cern.ch",
                "KFPR(181,2)= 5          ! Q = b    Registered by Alexandre.Nikitenko@cern.ch",
                "IMSS(1)= 1              ! MSSM ",
                "RMSS(5)= 20.            ! tan beta",
                "RMSS(19)= 200.          ! m_A",
                # Higgs boson decays
                "MDME(334,1)=0           ! Higgs(H) decay into d               dbar",
                "MDME(335,1)=0           ! Higgs(H) decay into u               ubar",
                "MDME(336,1)=0           ! Higgs(H) decay into s               sbar",
                "MDME(337,1)=0           ! Higgs(H) decay into c               cbar",
                "MDME(338,1)=0           ! Higgs(H) decay into b               bbar",
                "MDME(339,1)=0           ! Higgs(H) decay into t               tbar",
                "MDME(340,1)=0           ! Higgs(H) decay into b              bbar",
                "MDME(341,1)=0           ! Higgs(H) decay into t              tbar",
                "MDME(342,1)=0           ! Higgs(H) decay into e-              e+",
                "MDME(343,1)=0           ! Higgs(H) decay into mu-             mu+",
                "MDME(344,1)=1           ! Higgs(H) decay into tau-            tau+",
                "MDME(345,1)=0           ! Higgs(H) decay into tau-           tau+",
                "MDME(346,1)=0           ! Higgs(H) decay into g               g",
                "MDME(347,1)=0           ! Higgs(H) decay into gamma           gamma",
                "MDME(348,1)=0           ! Higgs(H) decay into gamma           Z0",
                "MDME(349,1)=0           ! Higgs(H) decay into Z0              Z0",
                "MDME(350,1)=0           ! Higgs(H) decay into W+              W-",
                "MDME(351,1)=0           ! Higgs(H) decay into Z0              h0",
                "MDME(352,1)=0           ! Higgs(H) decay into h0              h0",
                "MDME(353,1)=0           ! Higgs(H) decay into W+              H-",
                "MDME(354,1)=0           ! Higgs(H) decay into H+              W-",
                "MDME(355,1)=0           ! Higgs(H) decay into Z0              A0",
                "MDME(356,1)=0           ! Higgs(H) decay into h0              A0",
                "MDME(357,1)=0           ! Higgs(H) decay into A0              A0",
                "MDME(358,1)=0           ! Higgs(H) decay into ~chi_10         ~chi_10",
                "MDME(359,1)=0           ! Higgs(H) decay into ~chi_20         ~chi_10",
                "MDME(360,1)=0           ! Higgs(H) decay into ~chi_20         ~chi_20",
                "MDME(361,1)=0           ! Higgs(H) decay into ~chi_30         ~chi_10",
                "MDME(362,1)=0           ! Higgs(H) decay into ~chi_30         ~chi_20", 
                "MDME(363,1)=0           ! Higgs(H) decay into ~chi_30         ~chi_30", 
                "MDME(364,1)=0           ! Higgs(H) decay into ~chi_40         ~chi_10", 
                "MDME(365,1)=0           ! Higgs(H) decay into ~chi_40         ~chi_20", 
                "MDME(366,1)=0           ! Higgs(H) decay into ~chi_40         ~chi_30", 
                "MDME(367,1)=0           ! Higgs(H) decay into ~chi_40         ~chi_40", 
                "MDME(368,1)=0           ! Higgs(H) decay into ~chi_1+         ~chi_1-", 
                "MDME(369,1)=0           ! Higgs(H) decay into ~chi_1+         ~chi_2-", 
                "MDME(370,1)=0           ! Higgs(H) decay into ~chi_2+         ~chi_1-", 
                "MDME(371,1)=0           ! Higgs(H) decay into ~chi_2+         ~chi_2-", 
                "MDME(372,1)=0           ! Higgs(H) decay into ~d_L            ~d_Lbar", 
                "MDME(373,1)=0           ! Higgs(H) decay into ~d_R            ~d_Rbar", 
                "MDME(374,1)=0           ! Higgs(H) decay into ~d_L            ~d_Rbar", 
                "MDME(375,1)=0           ! Higgs(H) decay into ~d_Lbar         ~d_R", 
                "MDME(376,1)=0           ! Higgs(H) decay into ~u_L            ~u_Lbar", 
                "MDME(377,1)=0           ! Higgs(H) decay into ~u_R            ~u_Rbar", 
                "MDME(378,1)=0           ! Higgs(H) decay into ~u_L            ~u_Rbar", 
                "MDME(379,1)=0           ! Higgs(H) decay into ~u_Lbar         ~u_R", 
                "MDME(380,1)=0           ! Higgs(H) decay into ~s_L            ~s_Lbar", 
                "MDME(381,1)=0           ! Higgs(H) decay into ~s_R            ~s_Rbar", 
                "MDME(382,1)=0           ! Higgs(H) decay into ~s_L            ~s_Rbar", 
                "MDME(383,1)=0           ! Higgs(H) decay into ~s_Lbar         ~s_R", 
                "MDME(384,1)=0           ! Higgs(H) decay into ~c_L            ~c_Lbar", 
                "MDME(385,1)=0           ! Higgs(H) decay into ~c_R            ~c_Rbar", 
                "MDME(386,1)=0           ! Higgs(H) decay into ~c_L            ~c_Rbar", 
                "MDME(387,1)=0           ! Higgs(H) decay into ~c_Lbar         ~c_R", 
                "MDME(388,1)=0           ! Higgs(H) decay into ~b_1            ~b_1bar", 
                "MDME(389,1)=0           ! Higgs(H) decay into ~b_2            ~b_2bar", 
                "MDME(390,1)=0           ! Higgs(H) decay into ~b_1            ~b_2bar", 
                "MDME(391,1)=0           ! Higgs(H) decay into ~b_1bar         ~b_2", 
                "MDME(392,1)=0           ! Higgs(H) decay into ~t_1            ~t_1bar", 
                "MDME(393,1)=0           ! Higgs(H) decay into ~t_2            ~t_2bar", 
                "MDME(394,1)=0           ! Higgs(H) decay into ~t_1            ~t_2bar", 
                "MDME(395,1)=0           ! Higgs(H) decay into ~t_1bar         ~t_2", 
                "MDME(396,1)=0           ! Higgs(H) decay into ~e_L-           ~e_L+", 
                "MDME(397,1)=0           ! Higgs(H) decay into ~e_R-           ~e_R+", 
                "MDME(398,1)=0           ! Higgs(H) decay into ~e_L-           ~e_R+", 
                "MDME(399,1)=0           ! Higgs(H) decay into ~e_L+           ~e_R-", 
                "MDME(400,1)=0           ! Higgs(H) decay into ~nu_eL          ~nu_eLbar", 
                "MDME(401,1)=0           ! Higgs(H) decay into ~nu_eR          ~nu_eRbar", 
                "MDME(402,1)=0           ! Higgs(H) decay into ~nu_eL          ~nu_eRbar", 
                "MDME(403,1)=0           ! Higgs(H) decay into ~nu_eLbar       ~nu_eR", 
                "MDME(404,1)=0           ! Higgs(H) decay into ~mu_L-          ~mu_L+", 
                "MDME(405,1)=0           ! Higgs(H) decay into ~mu_R-          ~mu_R+", 
                "MDME(406,1)=0           ! Higgs(H) decay into ~mu_L-          ~mu_R+", 
                "MDME(407,1)=0           ! Higgs(H) decay into ~mu_L+          ~mu_R-",
                "MDME(408,1)=0           ! Higgs(H) decay into ~nu_muL         ~nu_muLbar",
                "MDME(409,1)=0           ! Higgs(H) decay into ~nu_muR         ~nu_muRbar", 
                "MDME(410,1)=0           ! Higgs(H) decay into ~nu_muL         ~nu_muRbar",
                "MDME(411,1)=0           ! Higgs(H) decay into ~nu_muLbar      ~nu_muR",
                "MDME(412,1)=0           ! Higgs(H) decay into ~tau_1-         ~tau_1+",
                "MDME(413,1)=0           ! Higgs(H) decay into ~tau_2-         ~tau_2+",
                "MDME(414,1)=0           ! Higgs(H) decay into ~tau_1-         ~tau_2+",
                "MDME(415,1)=0           ! Higgs(H) decay into ~tau_1+         ~tau_2-",
                "MDME(416,1)=0           ! Higgs(H) decay into ~nu_tauL        ~nu_tauLbar", 
                "MDME(417,1)=0           ! Higgs(H) decay into ~nu_tauR        ~nu_tauRbar",
                "MDME(418,1)=0           ! Higgs(H) decay into ~nu_tauL        ~nu_tauRbar",
                "MDME(419,1)=0           ! Higgs(H) decay into ~nu_tauLbar     ~nu_tauR",
                # tau boson decays: tau1->mu, tau2->hadr
                "MDME(89,1)=0",
                "MDME(90,1)=0",
                "MDME(91,1)=1",
                "MDME(92,1)=1",
                "MDME(93,1)=1",
                "MDME(94,1)=1",
                "MDME(95,1)=1",
                "MDME(96,1)=1",
                "MDME(97,1)=1",
                "MDME(98,1)=1",
                "MDME(99,1)=1",
                "MDME(100,1)=1",
                "MDME(101,1)=1",
                "MDME(102,1)=1",
                "MDME(103,1)=1",
                "MDME(104,1)=1",
                "MDME(105,1)=1",
                "MDME(106,1)=1",
                "MDME(107,1)=1",
                "MDME(108,1)=1",
                "MDME(109,1)=1",
                "MDME(110,1)=1",
                "MDME(111,1)=1",
                "MDME(112,1)=1",
                "MDME(113,1)=1",
                "MDME(114,1)=1",
                "MDME(115,1)=1",
                "MDME(116,1)=1",
                "MDME(117,1)=1",
                "MDME(118,1)=1",
                "MDME(119,1)=1",
                "MDME(120,1)=1",
                "MDME(121,1)=1",
                "MDME(122,1)=1",
                "MDME(123,1)=1",
                "MDME(124,1)=1",
                "MDME(125,1)=1",
                "MDME(126,1)=1",
                "MDME(127,1)=1",
                "MDME(128,1)=1",
                "MDME(129,1)=1",
                "MDME(130,1)=1",
                "MDME(131,1)=1",
                "MDME(132,1)=1",
                "MDME(133,1)=1",
                "MDME(134,1)=1",
                "MDME(135,1)=1",
                "MDME(136,1)=1",
                "MDME(137,1)=1",
                "MDME(138,1)=1",
                "MDME(139,1)=1",
                "MDME(140,1)=1",
                "MDME(141,1)=1",
                "MDME(142,1)=1"
            }
            
            vstring pythiaMSSMmhmax = {    
                "RMSS(2)= 200.           ! SU(2) gaugino mass ",
                "RMSS(3)= 800.           ! SU(3) (gluino) mass ",
                "RMSS(4)= 200.           ! higgsino mass parameter",
                "RMSS(6)= 1000.          ! left slepton mass",
                "RMSS(7)= 1000.          ! right slepton mass",
                "RMSS(8)= 1000.          ! right slepton mass",
                "RMSS(9)= 1000.          ! right squark mass",
                "RMSS(10)= 1000.         ! left sq mass for 3th gen/heaviest stop mass",
                "RMSS(11)= 1000.         ! right sbottom mass/lightest sbotoom mass",
                "RMSS(12)= 1000.         ! right stop mass/lightest stop mass",
                "RMSS(13)= 1000.         ! left stau mass",
                "RMSS(14)= 1000.         ! right stau mass",
                "RMSS(15)= 2449.         ! Ab",
                "RMSS(16)= 2449.         ! At",
                "RMSS(17)= 2449.         ! Atau"
            }
        }
    }
    
    # simulation parameters
    include "Configuration/StandardSequences/data/Simulation.cff"
    include "Configuration/StandardSequences/data/VtxSmearedGauss.cff"
    include "Configuration/StandardSequences/data/MixingNoPileUp.cff" 
    
    # relaxed Tau L1 Trigger
    include "L1Trigger/L1ExtraFromDigis/data/l1extra.cff"
    replace l1extraParticleMap.singleTauMinEt = 10.
    replace l1extraParticleMap.doubleTauMinEt = 5.
    
    include "HLTrigger/btau/data/tau/TauHLT.cff"

    path p1 = { psim, pdigi }  # simulation, digitization
    
    path singleTauTrg    = { l1emulator, l1extra, singleTauL1NoHLT }
    path doubleTrkTauTrg = { l1emulator, l1extra, doubleTrkTauL1NoHLT }
    path caloPixelTauTrg = { l1emulator, l1extra, caloPixelTauL1NoHLT }
    
    
    # Event output
    include "Configuration/EventContent/data/EventContent.cff"
    module GEN-SIM-DIGI-HLT = PoolOutputModule 
    { 
        using FEVTSIMEventContent
        untracked string fileName = "file:test.root"
        untracked PSet datasets = {
            untracked PSet dataset1 = {
                untracked string dataTier = "GEN"
            }
            untracked PSet dataset2 = {
                untracked string dataTier = "SIM"
            }
            untracked PSet dataset3 = {
                untracked string dataTier = "DIGI"
            }
        }
    }
    
    endpath outpath = { GEN-SIM-DIGI-HLT }
    
    schedule = { p1, singleTauTrg, doubleTrkTauTrg, caloPixelTauTrg, outpath }
}
